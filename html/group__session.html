<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AWS Encryption SDK for C: Session APIs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AWS Encryption SDK for C
   &#160;<span id="projectnumber">v0.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Session APIs</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga3a102b234535436099f0821e677686f9"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__session.html#ga3a102b234535436099f0821e677686f9">aws_cryptosdk_alg_id</a> { <br />
&#160;&#160;<a class="el" href="group__session.html#gga3a102b234535436099f0821e677686f9ae9a0e9c4ec20c7bc05eff540d0a3518a">ALG_AES256_GCM_IV12_TAG16_HKDF_SHA384_ECDSA_P384</a> = 0x0378, 
<a class="el" href="group__session.html#gga3a102b234535436099f0821e677686f9a608e409a0a089e523c1a3c5c2d4358f0">ALG_AES192_GCM_IV12_TAG16_HKDF_SHA384_ECDSA_P384</a> = 0x0346, 
<a class="el" href="group__session.html#gga3a102b234535436099f0821e677686f9a60a401693315fd2d9e6bc67ecab15150">ALG_AES128_GCM_IV12_TAG16_HKDF_SHA256_ECDSA_P256</a> = 0x0214, 
<a class="el" href="group__session.html#gga3a102b234535436099f0821e677686f9a1f4eb60eec1094fa14ae1a00e5244cd1">ALG_AES256_GCM_IV12_TAG16_HKDF_SHA256</a> = 0x0178, 
<br />
&#160;&#160;<a class="el" href="group__session.html#gga3a102b234535436099f0821e677686f9abd6248d39fd3e73a039ea8067f9a1ab1">ALG_AES192_GCM_IV12_TAG16_HKDF_SHA256</a> = 0x0146, 
<a class="el" href="group__session.html#gga3a102b234535436099f0821e677686f9a0917b738806765b350a3231d67ec15f5">ALG_AES128_GCM_IV12_TAG16_HKDF_SHA256</a> = 0x0114, 
<a class="el" href="group__session.html#gga3a102b234535436099f0821e677686f9a8981ce1a64ea5a65bb8da1c629d3dfdf">ALG_AES256_GCM_IV12_TAG16_NO_KDF</a> = 0x0078, 
<a class="el" href="group__session.html#gga3a102b234535436099f0821e677686f9a905b839c9430229f0b5144ffdae97aa9">ALG_AES192_GCM_IV12_TAG16_NO_KDF</a> = 0x0046, 
<br />
&#160;&#160;<a class="el" href="group__session.html#gga3a102b234535436099f0821e677686f9ae153dde03a5460253db8f485f6ed0d76">ALG_AES128_GCM_IV12_TAG16_NO_KDF</a> = 0x0014
<br />
 }</td></tr>
<tr class="separator:ga3a102b234535436099f0821e677686f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga128aab83f9c1b9519c622f747b49a19e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__session.html#ga128aab83f9c1b9519c622f747b49a19e">aws_cryptosdk_mode</a> { <a class="el" href="group__session.html#gga128aab83f9c1b9519c622f747b49a19eac5dc1afea741ccdc8458be722d096509">AWS_CRYPTOSDK_ENCRYPT</a> = 0x9000, 
<a class="el" href="group__session.html#gga128aab83f9c1b9519c622f747b49a19ea1143f2a82818e4efefc7ae24b3b0cdd3">AWS_CRYPTOSDK_DECRYPT</a> = 0x9001
 }</td></tr>
<tr class="separator:ga128aab83f9c1b9519c622f747b49a19e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga763808ac375e579ebd07a0ee9285a3ba"><td class="memItemLeft" align="right" valign="top">struct aws_cryptosdk_session *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__session.html#ga763808ac375e579ebd07a0ee9285a3ba">aws_cryptosdk_session_new_from_keyring</a> (struct aws_allocator *allocator, enum <a class="el" href="group__session.html#ga128aab83f9c1b9519c622f747b49a19e">aws_cryptosdk_mode</a> mode, struct <a class="el" href="structaws__cryptosdk__keyring.html">aws_cryptosdk_keyring</a> *keyring)</td></tr>
<tr class="separator:ga763808ac375e579ebd07a0ee9285a3ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae0942539031b2b8c1a14abfc81845f16"><td class="memItemLeft" align="right" valign="top">struct aws_cryptosdk_session *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__session.html#gae0942539031b2b8c1a14abfc81845f16">aws_cryptosdk_session_new_from_cmm</a> (struct aws_allocator *allocator, enum <a class="el" href="group__session.html#ga128aab83f9c1b9519c622f747b49a19e">aws_cryptosdk_mode</a> mode, struct <a class="el" href="structaws__cryptosdk__cmm.html">aws_cryptosdk_cmm</a> *cmm)</td></tr>
<tr class="separator:gae0942539031b2b8c1a14abfc81845f16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa690d827c07d8c1fa4441e2e0ab5da82"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__session.html#gaa690d827c07d8c1fa4441e2e0ab5da82">aws_cryptosdk_session_destroy</a> (struct aws_cryptosdk_session *session)</td></tr>
<tr class="separator:gaa690d827c07d8c1fa4441e2e0ab5da82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae3b107e88cd33c98df05a6a37b31d427"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__session.html#gae3b107e88cd33c98df05a6a37b31d427">aws_cryptosdk_session_reset</a> (struct aws_cryptosdk_session *session, enum <a class="el" href="group__session.html#ga128aab83f9c1b9519c622f747b49a19e">aws_cryptosdk_mode</a> mode)</td></tr>
<tr class="separator:gae3b107e88cd33c98df05a6a37b31d427"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4aad15397f8d35bb459f61d386795a27"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__session.html#ga4aad15397f8d35bb459f61d386795a27">aws_cryptosdk_session_set_frame_size</a> (struct aws_cryptosdk_session *session, uint32_t frame_size)</td></tr>
<tr class="separator:ga4aad15397f8d35bb459f61d386795a27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga74b000edb8c79cf35a9b131e23b933ba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__session.html#ga74b000edb8c79cf35a9b131e23b933ba">aws_cryptosdk_session_set_message_size</a> (struct aws_cryptosdk_session *session, uint64_t message_size)</td></tr>
<tr class="separator:ga74b000edb8c79cf35a9b131e23b933ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae545ae41942c20835f17fade547b5aee"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__session.html#gae545ae41942c20835f17fade547b5aee">aws_cryptosdk_session_set_message_bound</a> (struct aws_cryptosdk_session *session, uint64_t max_message_size)</td></tr>
<tr class="separator:gae545ae41942c20835f17fade547b5aee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab68c1609a18cd0a32035739767293e35"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__session.html#gab68c1609a18cd0a32035739767293e35">aws_cryptosdk_session_process</a> (struct aws_cryptosdk_session *session, uint8_t *outp, size_t outlen, size_t *out_bytes_written, const uint8_t *inp, size_t inlen, size_t *in_bytes_read)</td></tr>
<tr class="separator:gab68c1609a18cd0a32035739767293e35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga02df3f7639fb1ad34c6b0893d1ffc0b5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__session.html#ga02df3f7639fb1ad34c6b0893d1ffc0b5">aws_cryptosdk_session_is_done</a> (const struct aws_cryptosdk_session *session)</td></tr>
<tr class="separator:ga02df3f7639fb1ad34c6b0893d1ffc0b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e5506284e241c584cebc22b7b10ecfc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__session.html#ga1e5506284e241c584cebc22b7b10ecfc">aws_cryptosdk_session_get_alg_id</a> (const struct aws_cryptosdk_session *session, enum <a class="el" href="group__session.html#ga3a102b234535436099f0821e677686f9">aws_cryptosdk_alg_id</a> *alg_id)</td></tr>
<tr class="separator:ga1e5506284e241c584cebc22b7b10ecfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6df70e33a7b3eddd8155d54bee4281f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__session.html#ga6df70e33a7b3eddd8155d54bee4281f6">aws_cryptosdk_session_estimate_buf</a> (const struct aws_cryptosdk_session *AWS_RESTRICT session, size_t *AWS_RESTRICT outbuf_needed, size_t *AWS_RESTRICT inbuf_needed)</td></tr>
<tr class="separator:ga6df70e33a7b3eddd8155d54bee4281f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac54be89c4898b81516326fda5633008f"><td class="memItemLeft" align="right" valign="top">const struct aws_hash_table *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__session.html#gac54be89c4898b81516326fda5633008f">aws_cryptosdk_session_get_enc_ctx_ptr</a> (const struct aws_cryptosdk_session *session)</td></tr>
<tr class="separator:gac54be89c4898b81516326fda5633008f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab5ffeb4e7780ed0fc58bf684887ad7cb"><td class="memItemLeft" align="right" valign="top">struct aws_hash_table *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__session.html#gab5ffeb4e7780ed0fc58bf684887ad7cb">aws_cryptosdk_session_get_enc_ctx_ptr_mut</a> (struct aws_cryptosdk_session *session)</td></tr>
<tr class="separator:gab5ffeb4e7780ed0fc58bf684887ad7cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa7cd8c9a6ba12e8148b56dc043f54b9e"><td class="memItemLeft" align="right" valign="top">const struct aws_array_list *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__session.html#gaa7cd8c9a6ba12e8148b56dc043f54b9e">aws_cryptosdk_session_get_keyring_trace_ptr</a> (const struct aws_cryptosdk_session *session)</td></tr>
<tr class="separator:gaa7cd8c9a6ba12e8148b56dc043f54b9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The session is the primary API that encrypts or decrypts your data. To encrypt or decrypt data, configure your CMM, create a session object, and process your plaintext or ciphertext through this session object.</p>
<p>Typically using a session object will proceed through the following phases:</p>
<ol type="1">
<li>Create and configure a session object (or reuse an existing session that you have reset and configured)</li>
<li>Invoke <a class="el" href="group__session.html#gab68c1609a18cd0a32035739767293e35">aws_cryptosdk_session_process</a> in a loop that provide all of the input plaintext or ciphertext, and produces some output data</li>
<li>When encrypting, after all input data is consumed, <a class="el" href="group__session.html#ga74b000edb8c79cf35a9b131e23b933ba">aws_cryptosdk_session_set_message_size</a> (if it hasn't been called already) to mark the end of the message.</li>
<li>To process or generate trailing data, invoke <a class="el" href="group__session.html#gab68c1609a18cd0a32035739767293e35">aws_cryptosdk_session_process</a> in a loop with no input data until <a class="el" href="group__session.html#ga02df3f7639fb1ad34c6b0893d1ffc0b5">aws_cryptosdk_session_is_done</a> returns true.</li>
</ol>
<p>Most configuration functions will fail if invoked after the first call to <a class="el" href="group__session.html#gab68c1609a18cd0a32035739767293e35">aws_cryptosdk_session_process</a>, as the header is generated (thus committing the session to a particular set of parameters) at this time.</p>
<p>The session object does not internally buffer your data; if you pass buffers that are too small, it may process only a portion of the supplied data, or none at all. The <a class="el" href="group__session.html#ga6df70e33a7b3eddd8155d54bee4281f6">aws_cryptosdk_session_estimate_buf</a> function can be used to get a more accurate estimate of the amount of buffer space required to make further progress. </p>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga3a102b234535436099f0821e677686f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3a102b234535436099f0821e677686f9">&#9670;&nbsp;</a></span>aws_cryptosdk_alg_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__session.html#ga3a102b234535436099f0821e677686f9">aws_cryptosdk_alg_id</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Known algorithm suite names. For more information, see the <a href="https://docs.aws.amazon.com/encryption-sdk/latest/developer-guide/algorithms-reference.html">Algorithms Reference</a>. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga3a102b234535436099f0821e677686f9ae9a0e9c4ec20c7bc05eff540d0a3518a"></a>ALG_AES256_GCM_IV12_TAG16_HKDF_SHA384_ECDSA_P384&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga3a102b234535436099f0821e677686f9a608e409a0a089e523c1a3c5c2d4358f0"></a>ALG_AES192_GCM_IV12_TAG16_HKDF_SHA384_ECDSA_P384&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga3a102b234535436099f0821e677686f9a60a401693315fd2d9e6bc67ecab15150"></a>ALG_AES128_GCM_IV12_TAG16_HKDF_SHA256_ECDSA_P256&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga3a102b234535436099f0821e677686f9a1f4eb60eec1094fa14ae1a00e5244cd1"></a>ALG_AES256_GCM_IV12_TAG16_HKDF_SHA256&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga3a102b234535436099f0821e677686f9abd6248d39fd3e73a039ea8067f9a1ab1"></a>ALG_AES192_GCM_IV12_TAG16_HKDF_SHA256&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga3a102b234535436099f0821e677686f9a0917b738806765b350a3231d67ec15f5"></a>ALG_AES128_GCM_IV12_TAG16_HKDF_SHA256&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga3a102b234535436099f0821e677686f9a8981ce1a64ea5a65bb8da1c629d3dfdf"></a>ALG_AES256_GCM_IV12_TAG16_NO_KDF&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga3a102b234535436099f0821e677686f9a905b839c9430229f0b5144ffdae97aa9"></a>ALG_AES192_GCM_IV12_TAG16_NO_KDF&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga3a102b234535436099f0821e677686f9ae153dde03a5460253db8f485f6ed0d76"></a>ALG_AES128_GCM_IV12_TAG16_NO_KDF&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="header_8h_source.html#l00026">26</a> of file <a class="el" href="header_8h_source.html">header.h</a>.</p>

</div>
</div>
<a id="ga128aab83f9c1b9519c622f747b49a19e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga128aab83f9c1b9519c622f747b49a19e">&#9670;&nbsp;</a></span>aws_cryptosdk_mode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__session.html#ga128aab83f9c1b9519c622f747b49a19e">aws_cryptosdk_mode</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga128aab83f9c1b9519c622f747b49a19eac5dc1afea741ccdc8458be722d096509"></a>AWS_CRYPTOSDK_ENCRYPT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga128aab83f9c1b9519c622f747b49a19ea1143f2a82818e4efefc7ae24b3b0cdd3"></a>AWS_CRYPTOSDK_DECRYPT&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="session_8h_source.html#l00057">57</a> of file <a class="el" href="session_8h_source.html">session.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaa690d827c07d8c1fa4441e2e0ab5da82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa690d827c07d8c1fa4441e2e0ab5da82">&#9670;&nbsp;</a></span>aws_cryptosdk_session_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aws_cryptosdk_session_destroy </td>
          <td>(</td>
          <td class="paramtype">struct aws_cryptosdk_session *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Destroys a previously allocated session </p>

</div>
</div>
<a id="ga6df70e33a7b3eddd8155d54bee4281f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6df70e33a7b3eddd8155d54bee4281f6">&#9670;&nbsp;</a></span>aws_cryptosdk_session_estimate_buf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aws_cryptosdk_session_estimate_buf </td>
          <td>(</td>
          <td class="paramtype">const struct aws_cryptosdk_session *AWS_RESTRICT&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *AWS_RESTRICT&#160;</td>
          <td class="paramname"><em>outbuf_needed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *AWS_RESTRICT&#160;</td>
          <td class="paramname"><em>inbuf_needed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Estimates the amount of buffer space needed to make forward progress. Supplying the amount of data indicated here to <a class="el" href="group__session.html#gab68c1609a18cd0a32035739767293e35">aws_cryptosdk_session_process</a> guarantees that some kind of progress will be made - although this progress may in some cases only mean that the size estimates are updated with a (larger) more accurate value.</p>
<p>This method never fails, but if the session is in an error state or is only partially initialized, the returned sizes may not be meaningful. </p>

</div>
</div>
<a id="ga1e5506284e241c584cebc22b7b10ecfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1e5506284e241c584cebc22b7b10ecfc">&#9670;&nbsp;</a></span>aws_cryptosdk_session_get_alg_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aws_cryptosdk_session_get_alg_id </td>
          <td>(</td>
          <td class="paramtype">const struct aws_cryptosdk_session *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__session.html#ga3a102b234535436099f0821e677686f9">aws_cryptosdk_alg_id</a> *&#160;</td>
          <td class="paramname"><em>alg_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the algorithm ID in use for this message via *alg_id. Raises AWS_CRYPTOSDK_ERR_BAD_STATE if the algorithm ID has not yet been determined (in this case, the session remains usable and does not enter an error state). Guaranteed to succeed if <a class="el" href="group__session.html#ga02df3f7639fb1ad34c6b0893d1ffc0b5">aws_cryptosdk_session_is_done</a> returns true, but may succeed earlier in the message as well. </p>

</div>
</div>
<a id="gac54be89c4898b81516326fda5633008f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac54be89c4898b81516326fda5633008f">&#9670;&nbsp;</a></span>aws_cryptosdk_session_get_enc_ctx_ptr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct aws_hash_table* aws_cryptosdk_session_get_enc_ctx_ptr </td>
          <td>(</td>
          <td class="paramtype">const struct aws_cryptosdk_session *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns a read-only pointer to the encryption context held by the session. This will return NULL if it is called too early in the decryption process, before the SDK has finished deserializing and handling the encryption context from the header of the ciphertext.</p>
<p>This may be called at any time during or after the encryption process for read-only access to the encryption context, but for setting the encryption context, use aws_cryptosdk_get_enc_ctx_ptr_mut instead.</p>
<p>The hash table pointed to by this pointer lives until the session is reset or destroyed. If you want a copy of the encryption context that will outlive the session, you should duplicate it with aws_cryptosdk_enc_ctx_clone and then deallocate the copy with aws_cryptosdk_enc_ctx_clean_up when done with it. </p>

</div>
</div>
<a id="gab5ffeb4e7780ed0fc58bf684887ad7cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab5ffeb4e7780ed0fc58bf684887ad7cb">&#9670;&nbsp;</a></span>aws_cryptosdk_session_get_enc_ctx_ptr_mut()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct aws_hash_table* aws_cryptosdk_session_get_enc_ctx_ptr_mut </td>
          <td>(</td>
          <td class="paramtype">struct aws_cryptosdk_session *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns a mutable pointer to the encryption context held by the session. This will only return non-NULL when the session is in encrypt mode AND aws_cryptosdk_session_process has not yet been called.</p>
<p>The returned pointer will always point to an already initialized hash table. Callers MUST not clean up or re-initialize the hash table. The encryption context is an aws_hash_table with key and value both using the aws_string type.</p>
<p>See the interfaces in hash_table.h and string.h in aws-c-common for guidance on how to add elements to the encryption context.</p>
<p>Do not use this pointer across calls to the session. Doing so results in undefined behavior.</p>
<p>See documentation of aws_cryptosdk_session_get_enc_ctx_ptr for how to make your own copy of the encryption context, if desired. </p>

</div>
</div>
<a id="gaa7cd8c9a6ba12e8148b56dc043f54b9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa7cd8c9a6ba12e8148b56dc043f54b9e">&#9670;&nbsp;</a></span>aws_cryptosdk_session_get_keyring_trace_ptr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct aws_array_list* aws_cryptosdk_session_get_keyring_trace_ptr </td>
          <td>(</td>
          <td class="paramtype">const struct aws_cryptosdk_session *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns a read-only pointer to the keyring trace held by the session. This will return NULL if called too early in the encryption or decryption process. For best results, call after checking that aws_cryptosdk_session_is_done returns true.</p>
<p>When this returns a non-NULL pointer, it will always point to an already initialized aws_array_list with elements of type struct <a class="el" href="structaws__cryptosdk__keyring__trace__record.html">aws_cryptosdk_keyring_trace_record</a>.</p>
<p>See <a class="el" href="keyring__trace_8h.html">keyring_trace.h</a> for more information on the format of the trace.</p>
<p>The trace pointed to by this pointer lives until the session is reset or destroyed. If you want a copy of the trace that will outlive the session, you should duplicate it with aws_cryptosdk_keyring_trace_copy_all and then deallocate the copy with aws_cryptosdk_keyring_trace_clean_up when done with it. </p>

</div>
</div>
<a id="ga02df3f7639fb1ad34c6b0893d1ffc0b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga02df3f7639fb1ad34c6b0893d1ffc0b5">&#9670;&nbsp;</a></span>aws_cryptosdk_session_is_done()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool aws_cryptosdk_session_is_done </td>
          <td>(</td>
          <td class="paramtype">const struct aws_cryptosdk_session *&#160;</td>
          <td class="paramname"><em>session</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns true if the session has finished processing the entire message.</p>
<p>Your application should continue calling <a class="el" href="group__session.html#gab68c1609a18cd0a32035739767293e35">aws_cryptosdk_session_process</a> until this function returns true; trailing signatures require that some ciphertext data be processed after all plaintext has been consumed or generated. </p>

</div>
</div>
<a id="gae0942539031b2b8c1a14abfc81845f16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae0942539031b2b8c1a14abfc81845f16">&#9670;&nbsp;</a></span>aws_cryptosdk_session_new_from_cmm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct aws_cryptosdk_session* aws_cryptosdk_session_new_from_cmm </td>
          <td>(</td>
          <td class="paramtype">struct aws_allocator *&#160;</td>
          <td class="paramname"><em>allocator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__session.html#ga128aab83f9c1b9519c622f747b49a19e">aws_cryptosdk_mode</a>&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structaws__cryptosdk__cmm.html">aws_cryptosdk_cmm</a> *&#160;</td>
          <td class="paramname"><em>cmm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a new encryption or decryption session.</p>
<dl class="section return"><dt>Returns</dt><dd>The new session, or NULL on failure (in which case, an AWS error code is set)</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">allocator</td><td>The allocator to use for the session object and any temporary data allocated for the session </td></tr>
    <tr><td class="paramname">mode</td><td>The mode (AWS_CRYPTOSDK_ENCRYPT or AWS_CRYPTOSDK_DECRYPT) to start in. This can be changed later with <a class="el" href="group__session.html#gae3b107e88cd33c98df05a6a37b31d427">aws_cryptosdk_session_reset</a> </td></tr>
    <tr><td class="paramname">cmm</td><td>The crypto material manager which will provide key material for this session. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga763808ac375e579ebd07a0ee9285a3ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga763808ac375e579ebd07a0ee9285a3ba">&#9670;&nbsp;</a></span>aws_cryptosdk_session_new_from_keyring()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct aws_cryptosdk_session* aws_cryptosdk_session_new_from_keyring </td>
          <td>(</td>
          <td class="paramtype">struct aws_allocator *&#160;</td>
          <td class="paramname"><em>allocator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__session.html#ga128aab83f9c1b9519c622f747b49a19e">aws_cryptosdk_mode</a>&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structaws__cryptosdk__keyring.html">aws_cryptosdk_keyring</a> *&#160;</td>
          <td class="paramname"><em>keyring</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a new encryption or decryption session.</p>
<dl class="section return"><dt>Returns</dt><dd>The new session, or NULL on failure (in which case, an AWS error code is set)</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">allocator</td><td>The allocator to use for the session object and any temporary data allocated for the session </td></tr>
    <tr><td class="paramname">mode</td><td>The mode (AWS_CRYPTOSDK_ENCRYPT or AWS_CRYPTOSDK_DECRYPT) to start in. This can be changed later with <a class="el" href="group__session.html#gae3b107e88cd33c98df05a6a37b31d427">aws_cryptosdk_session_reset</a> </td></tr>
    <tr><td class="paramname">keyring</td><td>The keyring which will encrypt or decrypt data keys for this session. This function uses a default CMM to link the session and keyring. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab68c1609a18cd0a32035739767293e35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab68c1609a18cd0a32035739767293e35">&#9670;&nbsp;</a></span>aws_cryptosdk_session_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aws_cryptosdk_session_process </td>
          <td>(</td>
          <td class="paramtype">struct aws_cryptosdk_session *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>outp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>outlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>out_bytes_written</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>inlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>in_bytes_read</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Attempts to process some data through the cryptosdk session. This method may do any combination of</p><ol type="1">
<li>Consuming some data from the input buffer</li>
<li>Producing some data in the output buffer</li>
<li>Entering an error state, and raising the error in question.</li>
</ol>
<p>The data referenced by the input and output cursors must not overlap. If this method raises an error, the contents of the output buffer will be zeroed. The buffer referenced by the input buffer will never be modified.</p>
<p>If there is insufficient output space and/or insufficient input data, this method may not make any progress. The <a class="el" href="group__session.html#ga6df70e33a7b3eddd8155d54bee4281f6">aws_cryptosdk_session_estimate_buf</a> method may be used to determine how much data may be needed at this stage of processing. Note that these estimates may change once the header has been parsed.</p>
<p>Upon return, *out_bytes_written and *in_bytes_read will report the number of bytes consumed from the output and input buffers, respectively.</p>
<p>This method will return successfully unless the session has entered an error state. Use <a class="el" href="group__session.html#ga02df3f7639fb1ad34c6b0893d1ffc0b5">aws_cryptosdk_session_is_done</a> to determine if the entire message has been processed. </p>

</div>
</div>
<a id="gae3b107e88cd33c98df05a6a37b31d427"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae3b107e88cd33c98df05a6a37b31d427">&#9670;&nbsp;</a></span>aws_cryptosdk_session_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aws_cryptosdk_session_reset </td>
          <td>(</td>
          <td class="paramtype">struct aws_cryptosdk_session *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__session.html#ga128aab83f9c1b9519c622f747b49a19e">aws_cryptosdk_mode</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Resets the session, preparing it for a new message. This function can also change a session from encrypt to decrypt, or vice versa. After reset, the currently configured allocator, CMM, and frame size to use for encryption are preserved.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">session</td><td>The session to reset </td></tr>
    <tr><td class="paramname">mode</td><td>The new mode of the session </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga4aad15397f8d35bb459f61d386795a27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4aad15397f8d35bb459f61d386795a27">&#9670;&nbsp;</a></span>aws_cryptosdk_session_set_frame_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aws_cryptosdk_session_set_frame_size </td>
          <td>(</td>
          <td class="paramtype">struct aws_cryptosdk_session *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>frame_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the frame size to use for encryption. If zero is specified, the message will be processed in an unframed mode. If this function is not called, a reasonable default will be used.</p>
<p>This function will fail if invoked in decrypt mode, or if <a class="el" href="group__session.html#gab68c1609a18cd0a32035739767293e35">aws_cryptosdk_session_process</a> has been called. </p>

</div>
</div>
<a id="gae545ae41942c20835f17fade547b5aee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae545ae41942c20835f17fade547b5aee">&#9670;&nbsp;</a></span>aws_cryptosdk_session_set_message_bound()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aws_cryptosdk_session_set_message_bound </td>
          <td>(</td>
          <td class="paramtype">struct aws_cryptosdk_session *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>max_message_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Provides an upper bound on the message size. This hint is useful when the exact message size is not known up-front, but the configured CMM still needs to make use of message size information. For example, the caching CMM enforces an upper bound on the number of bytes encrypted under a cached key. If this method is not called, it must assume that you are processing an unbounded amount of data, and it will therefore bypass the cache.</p>
<p>This method may be called more than once (the smallest call wins). The session will enter an error state if more than the smallest bound of data is written, or if the precise message size passed to aws_cryptosdk_session_set_message_size exceeds the bound.</p>
<p>It is recommended that the bound be set before invoking <a class="el" href="group__session.html#gab68c1609a18cd0a32035739767293e35">aws_cryptosdk_session_process</a>; failing to do so will result in the CMM being passed an unbounded message size. This is an issue in particular with the caching CMM, which must then assume that your message will exceed size-based usage limits on cached keys. </p>

</div>
</div>
<a id="ga74b000edb8c79cf35a9b131e23b933ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga74b000edb8c79cf35a9b131e23b933ba">&#9670;&nbsp;</a></span>aws_cryptosdk_session_set_message_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int aws_cryptosdk_session_set_message_size </td>
          <td>(</td>
          <td class="paramtype">struct aws_cryptosdk_session *&#160;</td>
          <td class="paramname"><em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>message_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets the precise size of the message to encrypt. This function must be called exactly once during an encrypt operation. You do not need to call it before beginning to pass data, but providing the message size up front may improve efficiency.</p>
<p>If the session has already processed more than message_size bytes, or if this method is called more than once, the session will enter an error state.</p>
<p>This method is how the end of data is determined. If this is not called, <a class="el" href="group__session.html#gab68c1609a18cd0a32035739767293e35">aws_cryptosdk_session_process</a> cannot write the end-of-message frames and instead will continue to expect additional data.</p>
<p>Note that if the frame size is set to zero (i.e. this is a one-shot encrypt), a message size must be set before any input data can be processed. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
